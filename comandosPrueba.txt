‚úÖ ORDEN RECOMENDADO (RESET ‚Üí FLUJO COMPLETO)
0) Reset + levantar backend

Borra backend/data/sistema_dicc.db

Levanta:

mvn -pl backend -DskipTests clean spring-boot:run

1) Sanity check: login Jefatura
curl -u jonathan.guaman04@epn.edu.ec:Jefatura123* http://localhost:8080/api/v1/me

2) Crear proyecto (Jefatura) ‚úÖ (guarda el proyectoId)
curl -u jonathan.guaman04@epn.edu.ec:Jefatura123* \
  -H "Content-Type: application/json" \
  -d "{\"codigo\":\"PRJ-001\",\"nombre\":\"Proyecto IA\",\"correoDirector\":\"ariel.guana@epn.edu.ec\"}" \
  http://localhost:8080/api/v1/jefatura/proyectos


üìå Copia proyectoId del response y √∫salo en TODO lo siguiente.

3) Cambiar password Director (porque nace con Temp123*)
curl -u ariel.guana@epn.edu.ec:Temp123* \
  -H "Content-Type: application/json" \
  -d "{\"nuevaPassword\":\"Director2026*\"}" \
  http://localhost:8080/api/v1/auth/cambiar-password


(opcional)

curl -u ariel.guana@epn.edu.ec:Director2026* http://localhost:8080/api/v1/me

4) ‚úÖ NUEVO OBLIGATORIO: Director completa detalles del proyecto (define tipo/subtipo y maxAyudantes)

(Sin esto, maxAyudantes=0 y no podr√°s registrar ayudantes)

curl -u ariel.guana@epn.edu.ec:Director2026* \
  -X PUT \
  -H "Content-Type: application/json" \
  -d '{
    "fechaInicio":"2026-01-01",
    "fechaFin":"2026-12-31",
    "tipo":"INVESTIGACION",
    "subtipo":"INTERNO",
    "maxAyudantes":2,
    "maxArticulos":3
  }' \
  http://localhost:8080/api/v1/director/proyectos/PEGAR_PROYECTO_ID


‚úÖ Si este paso funciona, ya puedes registrar ayudantes.

5) Registrar ayudante + contrato (Director) ‚úÖ (guarda contratoId)
curl -u ariel.guana@epn.edu.ec:Director2026* \
  -H "Content-Type: application/json" \
  -d "{
    \"nombres\":\"Juan\",
    \"apellidos\":\"Perez\",
    \"correoInstitucional\":\"juan.perez@epn.edu.ec\",
    \"facultad\":\"FIS\",
    \"quintil\":2,
    \"tipoAyudante\":\"AYUDANTE_INVESTIGACION\",
    \"fechaInicioContrato\":\"2026-01-01\",
    \"fechaFinContrato\":\"2026-03-31\"
  }" \
  http://localhost:8080/api/v1/director/proyectos/PEGAR_PROYECTO_ID/ayudantes


üìå Copia contratoId y ayudanteId.

6) Login Ayudante (debe existir si NO exist√≠a antes)
curl -u juan.perez@epn.edu.ec:Temp123* http://localhost:8080/api/v1/me

7) Recontrataci√≥n (mismo correo ‚Üí NO debe crear usuario, solo nuevo contrato)
curl -u ariel.guana@epn.edu.ec:Director2026* \
  -H "Content-Type: application/json" \
  -d "{
    \"nombres\":\"Juan\",
    \"apellidos\":\"Perez\",
    \"correoInstitucional\":\"juan.perez@epn.edu.ec\",
    \"facultad\":\"FIS\",
    \"quintil\":2,
    \"tipoAyudante\":\"AYUDANTE_INVESTIGACION\",
    \"fechaInicioContrato\":\"2026-04-01\",
    \"fechaFinContrato\":\"2026-06-30\"
  }" \
  http://localhost:8080/api/v1/director/proyectos/PEGAR_PROYECTO_ID/ayudantes


‚úÖ Aqu√≠ debes ver:

nuevo contratoId

mismo ayudanteId

NO debe imprimir credenciales otra vez

‚ö†Ô∏è OJO: si maxAyudantes=2, y ya tienes 2 contratos ACTIVOS, este puede bloquearse si ambos quedan activos.
(idealmente en recontrataci√≥n, el contrato anterior deber√≠a estar INACTIVO, o el cupo se te llena)

8) Listar ayudantes/contratos del proyecto (Director)
curl -u ariel.guana@epn.edu.ec:Director2026* \
http://localhost:8080/api/v1/director/proyectos/PEGAR_PROYECTO_ID/ayudantes

9) Finalizar contrato (Director) (usa contratoId)
curl -u ariel.guana@epn.edu.ec:Director2026* \
  -H "Content-Type: application/json" \
  -d "{\"motivo\":\"RENUNCIA\"}" \
  http://localhost:8080/api/v1/director/contratos/PEGAR_CONTRATO_ID/finalizar


‚úÖ Luego, el conteo de activos baja.

‚úÖ CONSULTAS DE JEFATURA (control)
10) Resumen de proyectos (incluye tipo/subtipo + conteos)
curl -u jonathan.guaman04@epn.edu.ec:Jefatura123* \
http://localhost:8080/api/v1/jefatura/proyectos/resumen

11) Detalle de ayudantes/contratos por proyecto (Jefatura)
curl -u jonathan.guaman04@epn.edu.ec:Jefatura123* \
http://localhost:8080/api/v1/jefatura/proyectos/PEGAR_PROYECTO_ID/ayudantes

12) Total ayudantes activos global
curl -u jonathan.guaman04@epn.edu.ec:Jefatura123* \
http://localhost:8080/api/v1/jefatura/ayudantes/activos

13) Estad√≠sticas de proyectos por tipo y estado
curl -u jonathan.guaman04@epn.edu.ec:Jefatura123* \
http://localhost:8080/api/v1/jefatura/proyectos/estadisticas

14) Estad√≠sticas ayudantes activos total + por tipo
curl -u jonathan.guaman04@epn.edu.ec:Jefatura123* \
http://localhost:8080/api/v1/jefatura/ayudantes/estadisticas

‚úÖ SEM√ÅFORO (FASE 2.9)
15) Sem√°foro (antes de aprobar bit√°coras)
curl -u jonathan.guaman04@epn.edu.ec:Jefatura123* \
http://localhost:8080/api/v1/jefatura/semaforo

16) Insertar bit√°cora APROBADA (debug)
curl -X POST \
  -H "Content-Type: application/json" \
  -d '{
    "contratoId": "PEGAR_CONTRATO_ID",
    "anio": 2026,
    "mes": 1
  }' \
  http://localhost:8080/debug/bitacora/aprobar

17) Ver sem√°foro de nuevo
curl -u jonathan.guaman04@epn.edu.ec:Jefatura123* \
http://localhost:8080/api/v1/jefatura/semaforo


obtener/crear bit√°cora actual:

curl -u juan.perez@epn.edu.ec:Temp123* \
  -X POST \
  http://localhost:8080/api/v1/ayudante/bitacoras/actual


Crear semana:

curl -v -u juan.perez@epn.edu.ec:Temp123* \
  -H "Content-Type: application/json" \
  -X POST \
  --data-binary @- \
  "http://localhost:8080/api/v1/ayudante/bitacoras/id_bitacora/semanas" <<'JSON'
{
  "fechaInicioSemana":"2026-01-05",
  "fechaFinSemana":"2026-01-09",
  "actividadesRealizadas":"Avance del m√≥dulo de bit√°coras",
  "observaciones":"Sin novedades",
  "anexos":"-"
}
JSON


Crear actividades dentro de la semana

curl -u juan.perez@epn.edu.ec:Temp123* \
  -H "Content-Type: application/json" \
  -X POST \
  --data-binary @- \
  "http://localhost:8080/api/v1/ayudante/semanas/id_semana/actividades?trace=true" <<'JSON'
{
  "horaInicio":"08:00",
  "horaSalida":"10:00",
  "descripcion":"Reuni√≥n con director para revisi√≥n de avances"
}
JSON

Listar semanas de una bit√°cora

curl -u juan.perez@epn.edu.ec:Temp123* \
  "http://localhost:8080/api/v1/ayudante/bitacoras/id_bitacora/semanas"


Listar actividades de una semana

curl -u juan.perez@epn.edu.ec:Temp123* \
  "http://localhost:8080/api/v1/ayudante/semanas/id_semana/actividades"


Enviar bit√°cora (pasar a ENVIADA / PENDIENTE_REVISION)

curl -u juan.perez@epn.edu.ec:Temp123* \
  -H "Content-Type: application/json" \
  -X POST \
  "http://localhost:8080/api/v1/ayudante/bitacoras/55b3f6e0-3501-48e4-823e-23550fe7721b/enviar"


Director lista bit√°coras pendientes por proyecto

curl -u ariel.guana@epn.edu.ec:Director2026* \
  "http://localhost:8080/api/v1/director/proyectos/PEGAR_ID_PROYECTO/bitacoras/pendientes"

Director aprueba bit√°cora

curl -u ariel.guana@epn.edu.ec:Director2026* \
  -H "Content-Type: application/json" \
  -X POST \
  -d '{"decision":"APROBAR","observacion":"OK"}' \
  "http://localhost:8080/api/v1/director/bitacoras/55b3f6e0-3501-48e4-823e-23550fe7721b/revisar"
